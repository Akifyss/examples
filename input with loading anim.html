<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Input Box with Loading Animation</title>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Open Sans', sans-serif;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
        }
    </style>
</head>

<body class="bg-white flex items-center justify-center h-screen">
    <div class="relative" style="width: 400px; margin: 0 auto;">
        <input id="clearableInput" type="text" placeholder="输入文本并按下回车，可以多试几次"
            class="p-2 border border-gray-300 rounded shadow-sm focus:outline-none w-full">
        <div id="loader" class="loader hidden absolute left-3 top-3"></div>
        <div id="loadingText" class="hidden absolute left-8 top-3 text-sm font-semibold text-gray-700">Loading</div>
    </div>
</body>

<script>
    const input = document.getElementById('clearableInput');
    const loader = document.getElementById('loader');
    const loadingText = document.getElementById('loadingText');
    let timeoutId;

    function showLoadingAnimation(delay) {
        if (delay > 400) {
            timeoutId = setTimeout(() => {
                loader.classList.remove('hidden');
                loadingText.classList.remove('hidden');
            }, 400);
        }
    }

    function hideLoadingAnimation() {
        clearTimeout(timeoutId);
        loader.classList.add('hidden');
        loadingText.classList.add('hidden');
    }

    input.addEventListener('keydown', function (event) {
        if (event.key === 'Enter') {
            input.disabled = true; // 禁用输入框
            input.classList.add('bg-white');
            input.value = '';
            input.placeholder = '';
            const responseTime = Math.floor(Math.random() * 2000);
            showLoadingAnimation(responseTime);
            setTimeout(() => {
                hideLoadingAnimation();
                input.disabled = false; // 重新启用输入框
                input.focus(); // 自动focus激活输入框
                input.placeholder = '输入文本并按下回车，可以多试几次';
            }, Math.max(responseTime, 800));
        }
    });
</script>
</body>

</html>
<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>贝塞尔曲线</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.iconify.design/iconify-icon/2.0.0/iconify-icon.min.js"></script>
    <style>
        body {
            font-family: 'Open Sans', sans-serif;
        }

        .draggable {
            cursor: grab;
        }

        canvas {
            background-color: #f3f4f6;
        }
    </style>
</head>

<body>
    <div class="flex justify-center items-center h-screen">
        <canvas id="bezierCanvas" width="800" height="600"></canvas>
    </div>

    <script>
        const canvas = document.getElementById('bezierCanvas');
        const ctx = canvas.getContext('2d');
        const controlPoints = [
            { x: 100, y: 500, isDragging: false },
            { x: 400, y: 100, isDragging: false },
            { x: 700, y: 500, isDragging: false }
        ];

        let draggingPointId = null;

        // 绘制贝塞尔曲线
        function drawBezierCurve() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.beginPath();
            ctx.moveTo(controlPoints[0].x, controlPoints[0].y);
            ctx.bezierCurveTo(
                controlPoints[1].x, controlPoints[1].y,
                controlPoints[1].x, controlPoints[1].y,
                controlPoints[2].x, controlPoints[2].y
            );
            ctx.stroke();

            // 绘制控制点
            controlPoints.forEach(point => {
                ctx.beginPath();
                ctx.arc(point.x, point.y, 5, 0, Math.PI * 2);
                ctx.fill();
            });
        }

        // 更新控制点位置
        function updateControlPoint(index, x, y) {
            controlPoints[index].x = x;
            controlPoints[index].y = y;
            drawBezierCurve();
        }

        // 检查点击事件是否在控制点上
        function checkForControlPoint(x, y) {
            return controlPoints.findIndex(point => {
                return Math.sqrt((point.x - x) ** 2 + (point.y - y) ** 2) < 5;
            });
        }

        // 添加事件监听
        canvas.addEventListener('mousedown', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            const controlPointId = checkForControlPoint(x, y);

            if (controlPointId !== -1) {
                draggingPointId = controlPointId;
                controlPoints[controlPointId].isDragging = true;
            }
        });

        canvas.addEventListener('mousemove', (e) => {
            if (draggingPointId !== null) {
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                updateControlPoint(draggingPointId, x, y);
            }
        });

        canvas.addEventListener('mouseup', () => {
            if (draggingPointId !== null) {
                controlPoints[draggingPointId].isDragging = false;
                draggingPointId = null;
            }
        });

        // 初始绘制
        drawBezierCurve();
    </script>
</body>

</html>